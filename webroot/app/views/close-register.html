<div data-ng-controller="CloseRegisterController as closeCtrl">

  <link href="/css/dataTable.css" rel="stylesheet" type="text/css">
  <div class="portlet light bordered">

    <div class="page-content-wrapper" style="margin-top: 30px;">
      <div id="close-register-wrapper" class="line-box">
        <div class="col-md-12 col-sm-12 col-xs-12 col-omega col-alpha to_print">
          <div id="close-register-header" class="col-md-12 col-sm-12 col-xs-12">
            <h3><strong>Closing totals to verify</strong></h3>
            <h4>Register details</h4>
          </div>
          <div class="dashed-line"></div>
          <div id="close-register-details" class="col-md-12 col-sm-12 col-xs-12 col-alpha col-omega">
            <div class="col-md-6 col-sm-12 col-xs-6 col-alpha col-omega">
              <div class="col-md-12 col-sm-12 col-xs-12">
                <div class="col-md-4 col-sm-4 col-xs-4"><span>Register: </span></div>
                <div class="col-md-8 col-sm-8 col-xs-8">{{register.name}}</div>
              </div>
              <div class="col-md-12 col-sm-12 col-xs-12">
                <div class="col-md-4 col-sm-4 col-xs-4"><span>Outlet: </span></div>
                <div class="col-md-8 col-sm-8 col-xs-8">{{register.outlet_name}}</div>
              </div>
            </div>
            <div class="col-md-6 col-sm-12 col-xs-6 col-alpha col-omega">
              <div class="col-md-12 col-sm-12 col-xs-12">
                <div class="col-md-4 col-sm-4 col-xs-4"><span>Opened: </span></div>
                <div class="col-md-8 col-sm-8 col-xs-8">{{register.open_time}}</div>
              </div>
              <div class="col-md-12 col-sm-12 col-xs-12">
                <div class="col-md-4 col-sm-4 col-xs-4"><span>Closed: </span></div>
                <div class="col-md-8 col-sm-8 col-xs-8">{{register.close_time}}</div>
              </div>
            </div>
          </div>

          <!-- Section Sales -->
          <div id="close-register-sales" class="col-md-12 col-sm-12 col-xs-12">
            <h4><strong>Sales</strong></h4>
            <table class="col-md-12 col-sm-12 col-xs-12 sales-table">

              <tr style="border-top:4px double black;">
                <th>New sales</th>
                <th></th>
                <th class="text-right">{{register.total_sales | currency}}</th>
              </tr>
              <tr data-ng-repeat="sale in register.sales">
                <td></td>
                <td>{{sale.name}}</td>
                <td class="text-right">{{sale.total_sales | currency}}</td>
              </tr>
              <tr>
                <td></td>
                <td>Tax (GST)</td>
                <td class="text-right">{{register.total_taxes | currency}}</td>
              </tr>

              <tr style="border-top:4px double black;">
                <th>Discounts</th>
                <th></th>
                <th class="text-right">{{register.total_discounts | currency}}</th>
              </tr>

              <tr style="border-top:4px double black;">
                <th>Payments</th>
                <th></th>
                <th class="text-right">{{register.total_payments | currency}}</th>
              </tr>
              <tr data-ng-repeat="sale in register.sales">
                <td></td>
                <td>{{sale.name}}</td>
                <td class="text-right">{{sale.total_payments | currency}}</td>
              </tr>

              <tr style="border-top:4px double black;">
                <th>Total Transaction Count</th>
                <th></th>
                <th class="text-right">{{register.total_transactions}}</th>
              </tr>
            </table>
          </div>

          <!-- Section Payments -->
          <div id="close-register-payments" class="col-md-12 col-sm-12 col-xs-12">
            <h4><strong>Payments</strong></h4>
            <table class="dataTable table-bordered">
              <thead>
                <tr>
                  <th>Payment</th>
                  <th>Amount</th>
                  <th>To post</th>
                </tr>
              </thead>
              <tbody>
                <tr data-ng-repeat="payment in register.payments">
                  <td>{{payment.name}}</td>
                  <td class="text-right">{{payment.amount | currency}}</td>
                  <td>$ <input type="text" data-ng-model="payment.amount" data-ng-value="amount"></td>
                </tr>
              </tbody>
            </table>
          </div>

          <!-- Section Account Sales -->
          <div id="close-register-account" class="col-md-12 col-sm-12 col-xs-12">
            <h4><strong>Account sales</strong></h4>
            <table class="dataTable table-bordered">
              <thead>
                <tr>
                  <th>Date</th>
                  <th>Receipt #</th>
                  <th>User</th>
                  <th>Customer</th>
                  <th>Note</th>
                  <th>Amount</th>
                </tr>
              </thead>

              <!-- Layby sale started -->
              <tbody ng-if="register.layby_sales.sales.length > 0">
                  <tr style="background:#eee;">
                    <th style="border:0;">Layby sale started</th>
                    <th style="border:0;" colspan="5"></th>
                  </tr>
                  <tr data-ng-repeat="sale in register.layby_sales.sales">
                    <td>{{sale.sale_date}}</td>
                    <td>{{sale.reciept_number}}</td>
                    <td>{{sale.user_name}}</td>
                    <td>{{sale.customer_name}}</td>
                    <td>{{sale.note}}</td>
                    <td class="text-right">{{sale.amount | currency}}</td>
                  </tr>
                  <tr style="background:#FFF7D6">
                    <th style="border:0; text-align:right;" colspan="5">Total new laybys</th>
                    <td class="text-right" style="border:0;">{{register.layby_sales.total_sales | currency}}</td>
                  </tr>
              </tbody>

              <!-- Layby sale payments -->
              <tbody data-ng-if="register.layby_sales.payments.length > 0">
                <tr style="background:#eee;">
                  <th style="border:0;">Layby sale payments</th>
                  <th style="border:0;" colspan="5"></th>
                </tr>
                <tr data-ng-repeat="payment in register.layby_sales.payments">
                  <td>{{payment.sale_date}}</td>
                  <td>{{payment.reciept_number}}</td>
                  <td>{{payment.user_name}}</td>
                  <td>{{payment.customer_name}}</td>
                  <td>{{payment.note}}</td>
                  <td class="text-right">{{payment.amount | currency}}</td>
                </tr>
                <tr style="background:#FFF7D6">
                  <th style="border:0; text-align:right;" colspan="5">Total new laybys</th>
                  <td class="text-right" style="border:0;">{{register.layby_sales.total_payments | currency}}</td>
                </tr>
              </tbody>

              <!-- Account sale started -->
              <tbody data-ng-if="register.account_sales.sales.length > 0">
                <tr style="background:#eee;">
                  <th style="border:0;">Account sale started</th>
                  <th style="border:0;" colspan="5"></th>
                </tr>
                <tr data-ng-repeat="sale in register.account_sales.sales">
                  <td>{{sale.sale_date}}</td>
                  <td class="text-center">{{sale.reciept_number}}</td>
                  <td>{{sale.user_name}}</td>
                  <td>{{sale.customer_name}}</td>
                  <td>{{sale.note}}</td>
                  <td class="text-right">{{sale.amount | currency}}</td>
                </tr>
                <tr style="background:#FFF7D6">
                  <th style="border:0; text-align:right;" colspan="5">Total new laybys</th>
                  <td class="text-right" style="border:0;">{{register.account_sales.total_sales | currency}}</td>
                </tr>
              </tbody>

              <!-- Account sale payments -->
              <tbody data-ng-if="register.account_sales.payments.length > 0">
                <tr style="background:#eee;">
                  <th style="border:0;">Account sale payments</th>
                  <th style="border:0;" colspan="5"></th>
                </tr>
                <tr data-ng-repeat="payment in register.account_sales.payments">
                  <td>{{payment.sale_date}}</td>
                  <td class="text-center">{{payment.reciept_number}}</td>
                  <td>{{payment.user_name}}</td>
                  <td>{{payment.customer_name}}</td>
                  <td>{{payment.note}}</td>
                  <td class="text-right">{{payment.amount | currency}}</td>
                </tr>
                <tr style="background:#FFF7D6">
                  <th style="border:0; text-align:right;" colspan="5">Total new accounts</th>
                  <td class="text-right" style="border:0;">{{register.account_sales.total_payments | currency}}</td>
                </tr>


              </tbody>
            </table>
          </div>
        </div>
        <div class="dashed-line"></div>
        <div class="col-md-12 col-sm-12 col-xs-12 pull-right margin-top-20 margin-bottom-20">
          <button class="btn btn-primary pull-right close-register">Close Register</button>
          <button class="btn btn-default pull-right margin-right-10 print">Print</button>
        </div>
      </div>
    </div>
    <div class="clearfix"></div>
  </div>
</div>